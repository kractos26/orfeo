<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
		<title>calendar-setup.js Source File</title>
		<link href="doxygen.css" rel="stylesheet" type="text/css">
		<link href="../../css/template.css" rel="stylesheet" type="text/css">
		<link href="../../css/zpcal.css" rel="stylesheet" type="text/css">
		</head><body>
		<div class="topMenuHeader"> 
			<div class="logo">
				<a href='http://www.zapatec.com/website/main/support.jsp'><img src='/website/main/images/logoNew.gif' alt='Zapatec Javascript Calendar' border='0' align='middle'></a>
				<span class='zpCalHeader'>
					DHTML Calendar Javascript Source Code Documentation
				</span>
			</div>
		</div>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>calendar-setup.js</h1><a href="calendar-setup_8js.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*  </span>
00002 <span class="comment"> * The Zapatec DHTML Calendar</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Copyright (c) 2004 by Zapatec, Inc.</span>
00005 <span class="comment"> * http://www.zapatec.com</span>
00006 <span class="comment"> * 1700 MLK Way, Berkeley, California,</span>
00007 <span class="comment"> * 94709, U.S.A.  </span>
00008 <span class="comment"> * All rights reserved.</span>
00009 <span class="comment"> *</span>
00010 <span class="comment"> * Original version written by Mihai Bazon,</span>
00011 <span class="comment"> * http://www.bazon.net/mishoo/calendar.epl</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * This file defines helper functions for setting up the calendar.  They are</span>
00014 <span class="comment"> * intended to help non-programmers get a working calendar on their site</span>
00015 <span class="comment"> * quickly.  This script should not be seen as part of the calendar.  It just</span>
00016 <span class="comment"> * shows you what one can do with the calendar, while in the same time</span>
00017 <span class="comment"> * providing a quick and simple method for setting it up.  If you need</span>
00018 <span class="comment"> * exhaustive customization of the calendar creation process feel free to</span>
00019 <span class="comment"> * modify this code to suit your needs (this is recommended and much better</span>
00020 <span class="comment"> * than modifying calendar.js itself).</span>
00021 <span class="comment"> */</span>
00022 
00023 <span class="comment">// $Id: calendar-setup.js,v 1.4 2005/01/03 00:22:49 dror Exp $</span>
00024 
<a name="l00068"></a><a class="code" href="calendar-setup_8js.html#a0">00068</a> <a class="code" href="utils_8js.html#a0">Zapatec</a>.Calendar.setup = function (params) {
00069         function param_default(pname, def) { <span class="keywordflow">if</span> (typeof params[pname] == <span class="stringliteral">"undefined"</span>) { params[pname] = def; } };
00070 
00071         param_default(<span class="stringliteral">"inputField"</span>,     null);
00072         param_default(<span class="stringliteral">"displayArea"</span>,    null);
00073         param_default(<span class="stringliteral">"button"</span>,         null);
00074         param_default(<span class="stringliteral">"eventName"</span>,      <span class="stringliteral">"click"</span>);
00075         param_default(<span class="stringliteral">"ifFormat"</span>,       <span class="stringliteral">"%Y/%m/%d"</span>);
00076         param_default(<span class="stringliteral">"daFormat"</span>,       <span class="stringliteral">"%Y/%m/%d"</span>);
00077         param_default(<span class="stringliteral">"singleClick"</span>,    <span class="keyword">true</span>);
00078         param_default(<span class="stringliteral">"disableFunc"</span>,    null);
00079         param_default(<span class="stringliteral">"dateStatusFunc"</span>, params[<span class="stringliteral">"disableFunc"</span>]); <span class="comment">// takes precedence if both are defined</span>
00080         param_default(<span class="stringliteral">"dateText"</span>,       null);
00081         param_default(<span class="stringliteral">"firstDay"</span>,       null);
00082         param_default(<span class="stringliteral">"align"</span>,          <span class="stringliteral">"Br"</span>);
00083         param_default(<span class="stringliteral">"range"</span>,          [1900, 2999]);
00084         param_default(<span class="stringliteral">"weekNumbers"</span>,    <span class="keyword">true</span>);
00085         param_default(<span class="stringliteral">"flat"</span>,           null);
00086         param_default(<span class="stringliteral">"flatCallback"</span>,   null);
00087         param_default(<span class="stringliteral">"onSelect"</span>,       null);
00088         param_default(<span class="stringliteral">"onClose"</span>,        null);
00089         param_default(<span class="stringliteral">"onUpdate"</span>,       null);
00090         param_default(<span class="stringliteral">"date"</span>,           null);
00091         param_default(<span class="stringliteral">"showsTime"</span>,      <span class="keyword">false</span>);
00092         param_default(<span class="stringliteral">"timeFormat"</span>,     <span class="stringliteral">"24"</span>);
00093         param_default(<span class="stringliteral">"electric"</span>,       <span class="keyword">true</span>);
00094         param_default(<span class="stringliteral">"step"</span>,           2);
00095         param_default(<span class="stringliteral">"position"</span>,       null);
00096         param_default(<span class="stringliteral">"cache"</span>,          <span class="keyword">false</span>);
00097         param_default(<span class="stringliteral">"showOthers"</span>,     <span class="keyword">false</span>);
00098         param_default(<span class="stringliteral">"multiple"</span>,       null);
00099 
00100         var tmp = [<span class="stringliteral">"inputField"</span>, <span class="stringliteral">"displayArea"</span>, <span class="stringliteral">"button"</span>];
00101         <span class="keywordflow">for</span> (var i in tmp) {
00102                 <span class="keywordflow">if</span> (typeof params[tmp[i]] == <span class="stringliteral">"string"</span>) {
00103                         params[tmp[i]] = document.getElementById(params[tmp[i]]);
00104                 }
00105         }
00106         <span class="keywordflow">if</span> (!(params.flat || params.multiple || params.inputField || params.displayArea || params.button)) {
00107                 alert(<span class="stringliteral">"Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code"</span>);
00108                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00109         }
00110 
00111         function onSelect(cal) {
00112                 var p = cal.params;
00113                 var update = (cal.dateClicked || p.electric);
00114                 <span class="keywordflow">if</span> (update &amp;&amp; p.flat) {
00115                         <span class="keywordflow">if</span> (typeof p.flatCallback == <span class="stringliteral">"function"</span>)
00116                                 p.flatCallback(cal);
00117                         <span class="keywordflow">else</span>
00118                                 alert(<span class="stringliteral">"No flatCallback given -- doing nothing."</span>);
00119                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00120                 }
00121                 <span class="keywordflow">if</span> (update &amp;&amp; p.inputField) {
00122                         p.inputField.value = cal.date.print(p.ifFormat);
00123                         <span class="keywordflow">if</span> (typeof p.inputField.onchange == <span class="stringliteral">"function"</span>)
00124                                 p.inputField.onchange();
00125                 }
00126                 <span class="keywordflow">if</span> (update &amp;&amp; p.displayArea)
00127                         p.displayArea.innerHTML = cal.date.print(p.daFormat);
00128                 <span class="keywordflow">if</span> (update &amp;&amp; p.singleClick &amp;&amp; cal.dateClicked)
00129                         cal.callCloseHandler();
00130                 <span class="keywordflow">if</span> (update &amp;&amp; typeof p.onUpdate == <span class="stringliteral">"function"</span>)
00131                         p.onUpdate(cal);
00132         };
00133 
00134         <span class="keywordflow">if</span> (params.flat != null) {
00135                 <span class="keywordflow">if</span> (typeof params.flat == <span class="stringliteral">"string"</span>)
00136                         params.flat = document.getElementById(params.flat);
00137                 <span class="keywordflow">if</span> (!params.flat) {
00138                         alert(<span class="stringliteral">"Calendar.setup:\n  Flat specified but can't find parent."</span>);
00139                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00140                 }
00141                 var cal = <span class="keyword">new</span> <a class="code" href="utils_8js.html#a0">Zapatec</a>.Calendar(params.firstDay, params.date, params.onSelect || onSelect);
00142                 cal.showsOtherMonths = params.showOthers;
00143                 cal.showsTime = params.showsTime;
00144                 cal.time24 = (params.timeFormat == <span class="stringliteral">"24"</span>);
00145                 cal.params = params;
00146                 cal.weekNumbers = params.weekNumbers;
00147                 cal.setRange(params.range[0], params.range[1]);
00148                 cal.setDateStatusHandler(params.dateStatusFunc);
00149                 cal.getDateText = params.dateText;
00150                 <span class="keywordflow">if</span> (params.ifFormat) {
00151                         cal.setDateFormat(params.ifFormat);
00152                 }
00153                 <span class="keywordflow">if</span> (params.inputField &amp;&amp; typeof params.inputField.value == <span class="stringliteral">"string"</span>) {
00154                         cal.parseDate(params.inputField.value);
00155                 }
00156                 cal.create(params.flat);
00157                 cal.show();
00158                 <span class="keywordflow">return</span> cal;
00159         }
00160 
00161         var triggerEl = params.button || params.displayArea || params.inputField;
00162         triggerEl[<span class="stringliteral">"on"</span> + params.eventName] = function() {
00163                 var dateEl = params.inputField || params.displayArea;
00164                 var dateFmt = params.inputField ? params.ifFormat : params.daFormat;
00165                 var mustCreate = <span class="keyword">false</span>;
00166                 var cal = window.calendar;
00167                 <span class="keywordflow">if</span> (!(cal &amp;&amp; params.cache)) {
00168                         window.calendar = cal = <span class="keyword">new</span> <a class="code" href="utils_8js.html#a0">Zapatec</a>.Calendar(params.firstDay,
00169                                                              params.date,
00170                                                              params.onSelect || onSelect,
00171                                                              params.onClose || function(cal) {
00172                                                                      <span class="keywordflow">if</span> (params.cache)
00173                                                                              cal.hide();
00174                                                                      <span class="keywordflow">else</span>
00175                                                                              cal.destroy();
00176                                                              });
00177                         cal.showsTime = params.showsTime;
00178                         cal.time24 = (params.timeFormat == <span class="stringliteral">"24"</span>);
00179                         cal.weekNumbers = params.weekNumbers;
00180                         cal.historyDateFormat = params.ifFormat || params.daFormat;
00181                         mustCreate = <span class="keyword">true</span>;
00182                 } <span class="keywordflow">else</span> {
00183                         <span class="keywordflow">if</span> (params.date)
00184                                 cal.setDate(params.date);
00185                         cal.hide();
00186                 }
00187                 <span class="keywordflow">if</span> (params.multiple) {
00188                         cal.multiple = {};
00189                         <span class="keywordflow">for</span> (var i = params.multiple.length; --i &gt;= 0;) {
00190                                 var d = params.multiple[i];
00191                                 var ds = d.print(<span class="stringliteral">"%Y%m%d"</span>);
00192                                 cal.multiple[ds] = d;
00193                         }
00194                 }
00195                 cal.showsOtherMonths = params.showOthers;
00196                 cal.yearStep = params.step;
00197                 cal.setRange(params.range[0], params.range[1]);
00198                 cal.params = params;
00199                 cal.setDateStatusHandler(params.dateStatusFunc);
00200                 cal.getDateText = params.dateText;
00201                 cal.setDateFormat(dateFmt);
00202                 <span class="keywordflow">if</span> (mustCreate)
00203                         cal.create();
00204                 <span class="keywordflow">if</span> (dateEl)
00205                         cal.parseDate(dateEl.value || dateEl.innerHTML);
00206                 <span class="comment">//cal.refresh();</span>
00207                 <span class="keywordflow">if</span> (!params.position)
00208                         cal.showAtElement(params.button || params.displayArea || params.inputField, params.align);
00209                 <span class="keywordflow">else</span>
00210                         cal.showAt(params.position[0], params.position[1]);
00211                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00212         };
00213 
00214         <span class="keywordflow">if</span> (params.closeEventName) {
00215                 triggerEl[<span class="stringliteral">"on"</span> + params.closeEventName] = function() {
00216                         <span class="keywordflow">if</span> (window.calendar)
00217                                 window.calendar.callCloseHandler();
00218                 };
00219         }
00220 
00221         <span class="keywordflow">return</span> cal;
00222 };
</pre></div><div class="footer" align=center> 
	<address style="align: right;"><small>
		Generated on Sun Mar 13 18:06:28 2005 by doxygen </small></address>
	<a href="/website/main/contact.jsp" class="lnkblue">Contact Us</a> | <a href="/website/main/employment.jsp" class="lnkblue">Employment</a> 
	<br>
	<br>
	&copy; 2004 <strong>Zapatec, Inc.</strong>

</div>
</body>
</html>
